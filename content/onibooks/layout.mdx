---
title: onipdf 보기 설정 layout
description: layout 메서드에 보기 설정 관련 로직 추가하기
date: 2024-10-19
---

<Callout>
  렌더링이 대충 정리가 되었으니, 이제 layout이랑 관련된 코드를 작성해보려고 한다.
  mupdf.js 데모에서는 보기 설정을 다루는 건 없어서 구조 자체는 pdfjs express의 구조에 따르고 있는데, 
  여기서는 page 모드는 현재 보여줄 DOM만 유지하고 있고, 페이지를 이동할 때마다 갈아끼우는 형태인 것 같다.

  이 방법이 좋을지, 아니면 스크롤 모드처럼 다 렌더링 시켜두고 스크롤 이동을 해주는게 좋을지 고민이 된다.
</Callout>

결론적으로는 기존처럼 스크롤 이동을 하는 방식으로한다.
사용성 측면에서 사용자에게 빠르게 렌더링된 페이지를 보여주는 것이 좋다고 생각을 했다. (onibooks는 사용성을 가장 고려한다!) 그리고 기존 코드와 최대한 동일하게 가져갈 수 있어서 유지보수 측면에서도 좋다.

그리고 메모리를 많이 잡아먹을 것 같다는 생각은 사실 스크롤 모드에서도 이런 점은 똑같이 적용이 되기 때문에.. 문제가 발생한다면 차차 해결해나가면 될 문제라고 본다.
또한 이런 점은 몇가지 최적화를 통해 개선할 수 있다고 본다.
1. 메인 스레드를 막지 않도록 비동기적으로 페이지를 렌더링한다.
2. 사용하지 않는 페이지의 캔버스 요소는 스크롤 모드처럼 width와 height를 제거하여 메모리 사용을 최소화 한다.
3. 그리고 이미 observer를 통해 우선적으로 렌더링해야하는 순서를 지정했기 때문에 불필요한 렌더링을 최소화 했다.

그래서 사용자로부터 전달 받은 콘텐츠의 height를 100%로 설정하고, overflow hidden 처리를 해서 스크롤이 발생하지 않도록 했다.
그상태로 스크롤 이동을 시켜주면 된다.

페이지를 이동할 때는 스크롤의 위치만 이동시켜주면 된다는 점!


**여기 김밥 앱에 데모 페이지를 넣어봐야지!**

